---
title: MAMBO Horizon WP4 - RSE Talk 
author:
  name: Jo Walsh
  affiliation: UK Centre for Ecology & Hydrology
  email: jowals@ceh.ac.uk
  orcid: 0000-0003-0268-2263
date: last-modified
date-format: long
abstract: |
    Presentation from a Research Software Engineer on the work involved making MAMBO code and data portable and reusable, with potential lessons for future effort
bibliography: references.bib
format:
  revealjs: 
    css: logo.css
---

:::: {.content-visible when-format="html" unless-format="revealjs"}
:::{.callout-tip}
Toggle between light and dark mode using the switch in the top-right corner.
:::
::::

## Overview 

* Being late to the project
* Making code and data more reusable
* Dreams and challenges

## Bit of background!

* _Digital Research_ group at the UK Centre for Ecology and Hydrology
* Fairly new team of Research Software Engineers with varied backgrounds
* Me: code and devops, mostly public sector, lots of open source geospatial
* Hoping to increase research support for open source hardware

## WP4 - shrub attributes from drone data

* Deep learning model (Attention Unet) for detecting shrub shapes from images
* Methods for attributing heights that then feed into biomass calculations
* Turning research prototypes into workshop material
* Publishing and documenting data! 

## Start with data 

:::: {.columns}

::: {.column width="70%"}

* [Data Management Plan](https://www.ceh.ac.uk/news-and-media/blogs/implementing-fair-wizard-ukceh)
* ???
* Deliverables

:::

::: {.column width="30%"}

![](images/dmp_gnome.png)

:::

::::

## Create shared archives

* Researchers have local, duplicate copies
* Data wants to live where the compute is!
* Everyone has their own complex needs and favourite ecosystem of tools
* Easy to get caught up in abstract, standards-driven designs
* Need to work where people already are

## s3 Cloud storage

* An Amazon Web Services protocol, but with open source implementations (MinIO)
* [guide.cloudnativegeo.org](https://guide.cloudnativegeo.org)
* Built-in readers and drivers in many open source libraries
* Lucky to have [JASMIN](https://jasmin.ac.uk/) offering s3 in the UK, via STFC

## Ideals 

* Spatial-Temporal Asset Catalogue - community standard, rooted in reuse
* STAC catalogue for metadata and query, linked to s3 storage
* DVC (Data Version Control) to link and track models and data from git
* Like [Microsoft's Planetary Computer](https://planetarycomputer.microsoft.com)
* [Pangeo @ EOSC](https://pangeo-eosc.vm.fedcloud.eu/)

## Challenges

* Our s3 storage in JASMIN is time-limited to the project funded phase
* Zenodo is lovely for archiving, but is it meant for programmatic reuse?
* We want to stay open, but is our infrastructure set up for a barrage of crawlers?

## Reproducible, reusable code

* From research prototype to installable package
* [EVERSE.eu](https://everse.software/) - European Virtual Institute for RSE
![three tiers view of evolving research software](images/everse_three_tiers.png)
* Continuously-running tests; simple packaging, direct install from git

## Scripts are now python packages

* This basically involves adding one file, `pyproject.toml`
![pip install direct from git into notebook](one_shot_install.png)

## Challenges 1

* More LLM-generated code
* If it must happen, generate tests, pipelines and packaging too!
* Tried it both ways, took about the same time


## Challenges 2

* Reproducible environments
* "Living off the land" approach to compute infrastructure (Colab)
* Making dependencies easy to install
* Lag keeping notebooks and packages synchronised
* But design for workshops encourages reusability, too

## Nice bits of s3 support in geospatial tools

![read and query a dataframe from a bucket](images/read_gpd_s3.png)

![quickly read a small window from a very small tiff file](images/rasterio_s3_window.png)

## Portability

* Move repositories from personal namespace to a shared Organisation
* Futureproof against people moving on
* [ICAERUS](https://icaerus.eu/) offer a shared platform for code and models, EU wide

## MAMBO WP4 Github (currently) Organisation

* We set up a [MAMBO Horizon WP4 Github Organisation](https://github.com/MAMBO-Horizon-WP4/) 

![MAMBO HORIZON WP4 git forge homepage](images/github_org_wp4.png)

## Reproducibility of metrics and models

* We would like a shared repository of these
* Platforms like MLFlow or DVC/CML
* Model cards documenting usage caveats and any ethical concerns
![Tensorboard views of training runs inside a jupyter notebook](images/tensorboard_notebook.png)

## Adaptability

* Github has powerful network effects, but who can say what its future holds?
* Trialling Codeberg for a bat bioacoustics data syndication project. **BatSync** just starting with Tom August - ([https://codeberg.org/BatSync](https://codeberg.org/BatSync))
![BatSync project on Codeberg](images/batsync_homepage.png)

## More information

[MAMBO Horizon WP4 on Github](https://github.com/MAMBO-Horizon-WP4/)
